{% extends 'blog/base.html' %}
{% block content %}
    <article>
        <h1>{{ post.title }}</h1>
        {% if post.featured_image %}
            <img src="{{ post.featured_image.url }}" class="img-fluid mb-3">
        {% endif %}
        <p>{{ post.content }}</p>
        
        <!-- 2.2 Like Button -->
        <div class="mb-3">
            <form action="{% url 'like_post' post.slug %}" method="POST">
                {% csrf_token %}
                <button type="submit" class="btn {% if is_liked %}btn-danger{% else %}btn-primary{% endif %}">
                    {% if is_liked %}Unlike{% else %}Like{% endif %}
                </button> 
                ({{ post.total_likes }} Likes)
            </form>
        </div>
    </article>

    <hr>
    <h3>Comments</h3>
    {% for comment in comments %}
        <div class="card mb-2 p-2">
            <strong>{{ comment.user }}</strong>: {{ comment.body }}
        </div>
    {% endfor %}

    {% if user.is_authenticated %}
        <form method="POST" class="mt-3">
            {% csrf_token %}
            {{ comment_form.as_p }}
            <button class="btn btn-success">Submit Comment</button>
        </form>
    {% else %}
        <p><a href="{% url 'login' %}">Login</a> to comment.</p>
    {% endif %}
{% endblock %}